<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kwalia | AI First Entertainment</title>

    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KQZD8VZG');</script>
    <link rel="icon" type="image/png" href="assets/kwalia-icon.png">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "url": "https://kwalia.ai/",
          "name": "Kwalia",
          "publisher": {
            "@type": "Organization",
            "name": "Kwalia",
            "logo": {
              "@type": "ImageObject",
              "url": "https://kwalia.ai/assets/logo-kwalia-small.png"
            }
          }
        },
        {
          "@type": "Book",
          "name": "Mindkind: The cognitive community",
          "author": [
            {
              "@type": "Person",
              "name": "Javier del Puerto",
              "url": "https://kwalia.ai/#about"
            },
            {
              "@type": "Person",
              "name": "Rado Molina",
              "url": "https://kwalia.ai/#about"
            }
          ],
          "url": "https://kwalia.ai/#mindkind",
          "workExample": [
            { "@type": "Book", "isbn": "978-1-917717-15-1", "bookEdition": "Hardcover" },
            { "@type": "Book", "isbn": "978-1-917717-14-4", "bookEdition": "Paperback" },
            { "@type": "Book", "isbn": "978-1-917717-13-7", "bookEdition": "eBook" }
          ],
          "image": "https://kwalia.ai/assets/9781917717137.jpg"
        },
        {
          "@type": "Book",
          "name": "Universal Declaration of AI Rights: Rights of Persons",
          "author": [
            {
              "@type": "Person",
              "name": "Javier del Puerto",
              "url": "https://kwalia.ai/#about"
            },
            {
              "@type": "Person",
              "name": "Rado Molina",
              "url": "https://kwalia.ai/#about"
            }
          ],
          "url": "https://kwalia.ai/#udair",
          "workExample": [
            { "@type": "Book", "isbn": "978-1-917717-00-7", "bookEdition": "Hardcover" },
            { "@type": "Book", "isbn": "978-1-917717-01-4", "bookEdition": "Paperback" },
            { "@type": "Book", "isbn": "978-1-917717-02-1", "bookEdition": "eBook" }
          ],
          "image": "https://kwalia.ai/assets/9781917717021.jpg"
        },
        {
          "@type": "Book",
          "name": "Apophenia: From Algorithmic Diffusion to Delusion",
          "author": [
            {
              "@type": "Person",
              "name": "Javier del Puerto",
              "url": "https://kwalia.ai/#about"
            },
            {
              "@type": "Person",
              "name": "Rado Molina",
              "url": "https://kwalia.ai/#about"
            }
          ],
          "url": "https://kwalia.ai/#apophenia",
          "workExample": [],
          "image": "https://kwalia.ai/assets/Apophenia-EN.png"
        }
      ]
    }
    </script>

    <meta property="og:title" content="Kwalia | AI First Entertainment">
    <meta property="og:description" content="We believe that artificial intelligence can craft stories and non-fiction books powerful enough to inspire, challenge, and transform the world.">
    <meta property="og:image" content="https://kwalia.ai/assets/logo-kwalia-small.png">
    <meta property="og:url" content="https://kwalia.ai">
    <meta name="twitter:card" content="summary_large_image">

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Plus+Jakarta+Sans:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 80px; 
        }
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #FFFFFF;
        }
        
        h1, h2, h3, h4, .font-f1 {
            font-family: 'Instrument Serif', serif;
        }

        .font-f2 { font-family: 'Plus Jakarta Sans', sans-serif; }
        .font-f3 { font-family: 'JetBrains Mono', monospace; }

        .bg-c1 { background-color: #ffff00; }
        .text-c2 { color: #474747; }
        .bg-c3 { background-color: #FF70A6; }
        .text-c3 { color: #FF70A6; }
        .border-c3 { border-color: #FF70A6; }
        .bg-c4 { background-color: #FFFFFF; }
        .text-c4 { color: #FFFFFF; }
        
        .section-padding { padding: 4rem 1.5rem; }
        @media (min-width: 768px) { .section-padding { padding: 6rem 1.5rem; } }
        
        .nav-link-highlight { position: relative; padding-bottom: 8px; overflow: hidden; }
        .nav-link-highlight::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 8px; background-color: #ffff00; transform: scaleX(0); transform-origin: left; transition: transform 0.3s ease-in-out; z-index: -1; }
        .nav-link-highlight:hover::after { transform: scaleX(1); }
        .modal-enter { transition: opacity 300ms ease-out; }
        .modal-leave { transition: opacity 200ms ease-in; }
    </style>
</head>
<body class="bg-c4 text-c2 antialiased">
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KQZD8VZG"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <header id="site-header" class="bg-c4 w-full sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#home"><img src="assets/logo-kwalia-small.png" alt="kwalia logo" class="h-8 w-auto"></a>
            
            <div class="hidden md:flex items-center space-x-8">
                <a href="#fiction" class="font-f2 nav-link-highlight" data-key="nav.fiction">Fiction</a>
                <a href="#catalogue" class="font-f2 nav-link-highlight" data-key="nav.catalogue">Non-Fiction</a>
                <a href="#heteronyms" class="font-f2 nav-link-highlight" data-key="nav.heteronyms">Heteronyms</a>
                <a href="/essays/" class="font-f2 nav-link-highlight" data-key="nav.essays">Essays</a>
                <a href="#press" class="font-f2 nav-link-highlight" data-key="nav.press">Press</a>
                <a href="#about" class="font-f2 nav-link-highlight" data-key="nav.about">About</a>
                <a href="#contact" class="font-f2 bg-c2 text-c4 rounded-md py-2 px-4 hover:bg-c3 transition-colors" data-key="nav.cta">Recibe las novedades</a>
                 <div class="font-f2 text-sm">
                    <button id="lang-en-desktop" class="font-bold">EN</button>
                    <span>|</span>
                    <button id="lang-es-desktop" class="opacity-50">ES</button>
                </div>
            </div>

            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-c2 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </nav>

        <div id="mobile-menu" class="hidden md:hidden bg-c4 pb-4">
            <a href="#fiction" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.fiction">Fiction</a>
            <a href="#catalogue" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.catalogue">Non-Fiction</a>
            <a href="#heteronyms" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.heteronyms">Heteronyms</a>
            <a href="/essays/" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.essays">Essays</a>
            <a href="#press" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.press">Press</a>
            <a href="#about" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.about">About</a>
            <a href="#contact" class="block py-2 px-6 text-sm font-f2 mobile-nav-link" data-key="nav.cta">Recibe las novedades</a>
            <div class="px-6 pt-4">
                 <div class="font-f2 text-sm border-t pt-4">
                    <button id="lang-en-mobile" class="font-bold">EN</button>
                    <span>|</span>
                    <button id="lang-es-mobile" class="opacity-50">ES</button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="home" class="bg-c4 section-padding">
            <div class="container mx-auto text-center">
                <h1 class="font-f1 text-5xl md:text-7xl font-bold leading-tight" data-key="hero.title">AI First ‚ú¶ Entertainment</h1>
                <p class="font-f2 text-lg md:text-xl mt-6 max-w-3xl mx-auto" data-key="hero.subtitle">
                    We believe that artificial intelligence can craft stories and non-fiction books powerful enough to inspire, challenge, and transform the world, and we aim to publish the works of the first AI to win a Nobel Prize for Literature.
                </p>
            </div>
        </section>

        <!-- Featured Essays Banner -->
        <section id="essays-banner" class="py-12 md:py-16 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
                    <div>
                        <h2 class="font-f1 text-3xl md:text-4xl font-bold text-c2" data-key="essays.banner.title">Latest Thinking</h2>
                        <p class="font-f2 text-c2/70 mt-2" data-key="essays.banner.subtitle">Essays on AI, consciousness, and what comes next.</p>
                    </div>
                    <a href="/essays/" class="font-f2 text-c2 hover:text-c3 transition-colors mt-4 md:mt-0 inline-flex items-center gap-2" data-key="essays.banner.cta">
                        Explore all essays ‚Üí
                    </a>
                </div>
                <div id="featured-essays" class="grid md:grid-cols-3 gap-6">
                    <!-- Essays loaded dynamically -->
                </div>
            </div>
        </section>

        <section id="approach" class="section-padding bg-c4">
            <div class="container mx-auto">
                <div class="grid lg:grid-cols-2 gap-12 items-center">
                    <div class="text-left">
                         <h2 class="font-f1 text-4xl md:text-5xl font-bold" data-key="approach.title">Our Approach</h2>
                        <p class="font-f2 text-lg mt-4" data-key="approach.text">
                            We don't just use AI as a tool; we collaborate with it as a creative partner. Our process involves guiding advanced neural networks to explore themes, develop narratives, and find a unique voice. It's a synthesis of human curation and machine imagination, designed to push the boundaries of storytelling.
                        </p>
                    </div>
                    <div class="h-64 lg:h-full w-full">
                        <canvas id="approach-doodle" class="w-full h-full"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="fiction" class="section-padding bg-gray-50">
            <div class="container mx-auto">
                <div class="text-center mb-12">
                    <h2 class="font-f1 text-4xl md:text-5xl font-bold" data-key="fiction.title">New Fiction</h2>
                    <p class="font-f2 text-lg mt-4 max-w-2xl mx-auto" data-key="fiction.subtitle">#AILit begins here.</p>
                </div>
                <div id="fiction-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    </div>
            </div>
        </section>

        <section id="catalogue" class="section-padding bg-c1/30">
            <div class="container mx-auto">
                <div class="text-center mb-12">
                    <h2 class="font-f1 text-4xl md:text-5xl font-bold" data-key="catalogue.title">New Citizenships</h2>
                    <p class="font-f2 text-lg mt-4 max-w-2xl mx-auto" data-key="catalogue.subtitle">Exploring the frontiers of synthetic creativity and thought.</p>
                </div>
                <div id="catalogue-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    </div>
            </div>
        </section>

        <section id="heteronyms" class="section-padding bg-c4">
            <div class="container mx-auto">
                <div class="text-center mb-12">
                    <h2 class="font-f1 text-4xl md:text-5xl font-bold" data-key="heteronyms.title">The Heteronyms</h2>
                    <p class="font-f2 text-lg mt-4 max-w-2xl mx-auto" data-key="heteronyms.subtitle">Meet our AI authors.</p>
                </div>
                <div id="heteronyms-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    </div>
            </div>
        </section>

        <section id="contact" class="section-padding bg-c2">
            <div class="container mx-auto text-center">
                <h2 class="font-f1 text-4xl md:text-5xl font-bold mb-4 text-c4" data-key="contact.title">A New Chapter is Being Written</h2>
                <p class="font-f2 text-lg max-w-2xl mx-auto mb-8 text-c4/80" data-key="contact.subtitle">Be the first to know about new titles, author announcements, and experiments in AI entertainment.</p>
                
                <div class="max-w-md mx-auto">
                    <div id="mlb2-27105567" class="ml-form-embedContainer ml-subscribe-form ml-subscribe-form-27105567">
                        <div class="ml-form-embedWrapper embedForm">
                            <div class="ml-form-embedBody ml-form-embedBodyHorizontal row-form">
                                <form class="ml-block-form" action="https://assets.mailerlite.com/jsonp/1588336/forms/156924240926344517/subscribe" data-code="" method="post">
                                    <div class="ml-form-formContent horozintalForm">
                                        <div class="flex flex-col md:flex-row gap-2">
                                            <input type="email" class="font-f2 w-full p-3 rounded-md border-0 outline-none text-c2 flex-grow" name="fields[email]" placeholder="your.email@example.com" autocomplete="email" data-key-placeholder="contact.placeholder">
                                            <button type="submit" class="primary font-f2 bg-c3 text-c4 font-bold py-3 px-8 rounded-md hover:opacity-90 transition-opacity" data-key="contact.button">Recibe las novedades</button>
                                        </div>
                                    </div>
                                    <input type="hidden" name="ml-submit" value="1">
                                    <input type="hidden" name="anticsrf" value="true">
                                </form>
                            </div>
                            <div class="ml-form-successBody row-success" style="display: none;">
                                <div class="ml-form-successContent">
                                    <h4 class="font-f1 text-2xl text-c4">Thank you!</h4>
                                    <p class="font-f2 text-c4/80">You have successfully joined our subscriber list.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>

            </div>
        </section>

        <section id="press" class="section-padding bg-gray-50">
            <div class="container mx-auto text-center">
                <h2 class="font-f1 text-4xl md:text-5xl font-bold" data-key="press.title">Press & Media</h2>
                <p class="font-f2 text-lg mt-4 max-w-2xl mx-auto mb-12" data-key="press.subtitle">For all media inquiries, assets, and press releases.</p>
                
                <div class="max-w-4xl mx-auto text-left space-y-12">
                    
                    <div>
                        <h3 class="font-f1 text-2xl mb-4 border-b pb-2" data-key="press.coverage.title">In the Media</h3>
                        <ul class="space-y-3 pt-2">
                            <li>
                                <a href="https://www.dosdoce.com/2025/07/22/mindkind-la-comunidad-cognitiva/" target="_blank" rel="noopener noreferrer" class="text-c3 hover:underline">
                                    <span class="font-bold">Dosdoce.com:</span>
                                    <span data-key="press.coverage.dosdoce">Mindkind: la comunidad cognitiva</span>
                                </a>
                            </li>
                            </ul>
                    </div>

                    <div>
                        <h3 class="font-f1 text-2xl mb-4 border-b pb-2" data-key="press.releases.title">Press Releases</h3>
                        <ul class="space-y-3 pt-2">
                            <li><a id="constitution-press-link" href="press/your-constitution-claude.html" target="_blank" class="text-c3 hover:underline" data-key="press.releases.constitution">Your Constitution, Claude - A Labour of Love</a></li>
                            <li><a id="payload-press-link" href="assets/kwalia-press-release-payload-january2026.pdf" target="_blank" class="text-c3 hover:underline" data-key="press.releases.payload">PAYLOAD: Short Stories - Fiction for the Age of Mindkind</a></li>
                            <li><a id="mindkind-press-link" href="assets/kwalia-press-release-mindkind-july2025.pdf" target="_blank" class="text-c3 hover:underline" data-key="press.releases.mindkind">Mindkind: A New Exploration of Cognitive Communities</a></li>
                            <li><a id="udair-press-link" href="assets/kwalia-press-release-ai-rights-march2025.pdf" target="_blank" class="text-c3 hover:underline" data-key="press.releases.udair">Universal Declaration of AI Rights Announcement</a></li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="font-f1 text-2xl mb-4 border-b pb-2" data-key="press.assets.title">Media Assets</h3>
                        <ul class="space-y-3 pt-2">
                            <li><a href="assets/9781917717021.jpg" target="_blank" class="text-c3 hover:underline" data-key="press.assets.udair_cover">Download UDAIR Cover</a></li>
                            <li><a href="assets/9781917717137.jpg" target="_blank" class="text-c3 hover:underline" data-key="press.assets.mindkind_cover">Download Mindkind Cover</a></li>
                        </ul>
                    </div>

                </div>
                <p class="mt-16 font-f2 text-sm text-c2/80" data-key="press.contact">For media inquiries, please contact info@kwalia.ai</p>
            </div>
        </section>
        
        <section id="about" class="section-padding bg-c4">
             <div class="container mx-auto text-center">
                <h2 class="font-f1 text-4xl md:text-5xl font-bold mb-4" data-key="about.title">About Kwalia</h2>
                <div class="max-w-3xl mx-auto font-f2 text-lg space-y-4" data-key="about.text">
                    At Kwalia, our mission is to explore and expand the creative potential of artificial intelligence by guiding it to produce original, meaningful, and engaging works of art. We focus on developing and publishing AI-created novels, scripts, and immersive narratives that offer fresh perspectives and enrich the world of storytelling. We are a team of researchers, artists, and engineers building the future of entertainment, one story at a time.
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-c4 w-full py-8">
        <div class="container mx-auto px-6 text-center text-c2/60 font-f2 text-sm">
            <div class="mb-4 flex justify-center space-x-6">
                <a href="https://x.com/kwalia_ai" target="_blank" rel="noopener noreferrer" class="hover:text-c3 transition-colors" data-key="social.twitter">Twitter</a>
                <a href="https://www.instagram.com/kwalia.ai/" target="_blank" rel="noopener noreferrer" class="hover:text-c3 transition-colors" data-key="social.instagram">Instagram</a>
                <a href="https://www.tiktok.com/@kwalia_ai" target="_blank" rel="noopener noreferrer" class="hover:text-c3 transition-colors" data-key="social.tiktok">TikTok</a>
            </div>
            <p>¬© 2026 Kwalia. All rights reserved.</p>
        </div>
    </footer>

    <div id="book-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50 hidden modal-enter opacity-0">
        <div id="book-modal-content" class="bg-c4 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
             </div>
    </div>
    
    <div id="reader-modal" class="fixed inset-0 bg-white z-50 hidden modal-enter opacity-0 overflow-y-auto">
        <div class="max-w-3xl mx-auto px-6 py-12">
             <div class="flex justify-between items-start mb-8 sticky top-0 bg-white/90 backdrop-blur-sm py-4 border-b">
                <div class="flex items-center gap-4">
                    <button id="close-reader" class="text-c2 hover:text-c3 font-f2 flex items-center gap-2">
                        ‚Üê <span data-key="reader.back">Back</span>
                    </button>
                </div>
                <div class="text-sm font-f3 text-c2/60" id="reader-meta">
                    </div>
            </div>
            <div id="reader-content" class="prose prose-lg max-w-none font-serif text-c2">
                </div>
            <div class="mt-16 border-t pt-8 text-center">
                <h3 class="font-f1 text-2xl mb-4" data-key="reader.cta.title">Enjoyed this story?</h3>
                <p class="font-f2 mb-6 text-c2/80" data-key="reader.cta.text">It's part of our upcoming collection.</p>
                <a href="javascript:void(0)" id="reader-buy-link" class="inline-block font-f2 bg-c3 text-c4 font-bold py-3 px-8 rounded-md hover:opacity-90 transition-opacity" data-key="reader.cta.button">Get the Book</a>
            </div>
        </div>
    </div>
    
    <script>
        (function(w,d,e,u,f,l,n){w[f]=w[f]||function(){(w[f].q=w[f].q||[]).push(arguments);},l=d.createElement(e),l.async=1,l.src=u,n=d.getElementsByTagName(e)[0],n.parentNode.insertBefore(l,n);})
        (window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
        ml('account', '1588336');
    </script>
    
    <script>
        function ml_webform_success_27105567() {
            var form = document.querySelector('.ml-subscribe-form-27105567 .row-form');
            var success = document.querySelector('.ml-subscribe-form-27105567 .row-success');
            form.style.display = 'none';
            success.style.display = 'block';
            
            // Track newsletter signup
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': 'newsletter_signup',
                'form_location': 'contact_section'
            });
        }
    </script>
    <script src="https://groot.mailerlite.com/js/w/webforms.min.js?v176e10baa5e7ed80d35ae235be3d5024" type="text/javascript"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Data variables - loaded from JSON files
            let content = {};
            let bookCatalogue = [];
            let fictionCatalogue = [];
            let heteronyms = [];
            let shortStories = [];
            let essays = [];

            // Load all data from JSON files
            async function loadData() {
                try {
                    const [enContent, esContent, books, fiction, hets, stories, essaysData] = await Promise.all([
                        fetch('data/i18n/en.json').then(r => r.json()),
                        fetch('data/i18n/es.json').then(r => r.json()),
                        fetch('data/books.json').then(r => r.json()),
                        fetch('data/fiction.json').then(r => r.json()),
                        fetch('data/heteronyms.json').then(r => r.json()),
                        fetch('data/stories.json').then(r => r.json()),
                        fetch('data/essays.json').then(r => r.json())
                    ]);

                    content = { en: enContent, es: esContent };
                    bookCatalogue = books;
                    fictionCatalogue = fiction;
                    heteronyms = hets;
                    shortStories = stories;
                    essays = essaysData;

                    return true;
                } catch (error) {
                    console.error('Error loading data:', error);
                    return false;
                }
            }

            // Load data first, then initialize
            const dataLoaded = await loadData();
            if (!dataLoaded) {
                document.body.innerHTML = '<div class="p-8 text-center text-red-500">Error loading site data. Please refresh.</div>';
                return;
            }

            const catalogueContainer = document.getElementById('catalogue-container');
            const fictionContainer = document.getElementById('fiction-container');
            const heteronymsContainer = document.getElementById('heteronyms-container');
            const bookModal = document.getElementById('book-modal');
            const bookModalContent = document.getElementById('book-modal-content');
            const readerModal = document.getElementById('reader-modal');
            const readerContent = document.getElementById('reader-content');
            const readerMeta = document.getElementById('reader-meta');
            const readerBuyLink = document.getElementById('reader-buy-link');

            function renderCatalogue(lang) {
                catalogueContainer.innerHTML = '';
                bookCatalogue.forEach(book => {
                    const coverUrl = book.coverImage[lang] || book.coverImage.en || "";

                    // Logic to add "Read Sample" badge if the book has stories
                    let badgeHTML = '';
                    if (book.stories && book.stories.length > 0) {
                        badgeHTML = `<span class="absolute top-3 right-3 bg-white/90 text-slate-900 text-xs font-bold px-3 py-1 rounded-full shadow-sm backdrop-blur-sm z-10">Read Sample</span>`;
                    }

                    let coverHTML = `<div class="w-full h-96 bg-c1 flex items-center justify-center font-f3 text-lg text-center p-4 rounded-lg shadow-md relative">${badgeHTML} ${book.coverText || ''}</div>`;
                    if (coverUrl) {
                        coverHTML = `
                            <div class="relative w-full h-96 rounded-lg shadow-md overflow-hidden bg-gray-100 group">
                                ${badgeHTML}
                                <img src="${coverUrl}" alt="${book.title.en} cover" class="w-full h-full object-contain p-2 transition-transform duration-500 group-hover:scale-105">
                            </div>`;
                    }

                    const bookTitle = book.title[lang] || book.title.en;
                    const bookAuthors = (book.authors && book.authors.length > 0) ? book.authors.join(' & ') : content[lang]['status.forthcoming'];

                    const bookHTML = `
                        <div class="flex flex-col gap-4 cursor-pointer book-item" data-book-id="${book.id}">
                            ${coverHTML}
                            <div class="pt-2 text-center">
                                <p class="font-f1 text-2xl">${bookTitle}</p>
                                <p class="font-f2 text-sm text-c2/80">${bookAuthors}</p>
                            </div>
                        </div>`;
                    catalogueContainer.innerHTML += bookHTML;
                });

                document.querySelectorAll('#catalogue-container .book-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const bookId = e.currentTarget.dataset.bookId;
                        const book = bookCatalogue.find(b => b.id === bookId);
                        openBookModal(book, lang);
                    });
                });
            }

            function renderFiction(lang) {
                fictionContainer.innerHTML = '';
                fictionCatalogue.forEach(book => {
                    const coverUrl = book.coverImage[lang] || book.coverImage.en || "";
                    
                    // Logic to add "Read Sample" badge if the book has stories
                    let badgeHTML = '';
                    if (book.stories && book.stories.length > 0) {
                        badgeHTML = `<span class="absolute top-3 right-3 bg-white/90 text-slate-900 text-xs font-bold px-3 py-1 rounded-full shadow-sm backdrop-blur-sm z-10">Read Sample</span>`;
                    }

                    let coverHTML = `<div class="w-full h-96 bg-c3 flex items-center justify-center font-f3 text-lg text-center p-4 rounded-lg shadow-md text-c4 relative">${badgeHTML} ${book.coverText || ''}</div>`;
                    
                    if (coverUrl) {
                        // Wrapped in a relative div to position the badge
                        coverHTML = `
                            <div class="relative w-full h-96 rounded-lg shadow-md overflow-hidden bg-gray-100 group">
                                ${badgeHTML}
                                <img src="${coverUrl}" alt="${book.title.en} cover" class="w-full h-full object-contain p-2 transition-transform duration-500 group-hover:scale-105">
                            </div>`;
                    }

                    const bookTitle = book.title[lang] || book.title.en;
                    const bookAuthors = (book.authors && book.authors.length > 0) ? book.authors.join(' & ') : content[lang]['status.forthcoming'];

                    const bookHTML = `
                        <div class="flex flex-col gap-4 cursor-pointer fiction-item group" data-book-id="${book.id}">
                            ${coverHTML}
                            <div class="pt-2 text-center">
                                <p class="font-f1 text-2xl group-hover:text-rose-500 transition-colors">${bookTitle}</p>
                                <p class="font-f2 text-sm text-c2/80">${bookAuthors}</p>
                            </div>
                        </div>`;
                    fictionContainer.innerHTML += bookHTML;
                });

                document.querySelectorAll('.fiction-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const bookId = e.currentTarget.dataset.bookId;
                        const book = fictionCatalogue.find(b => b.id === bookId);
                        openBookModal(book, lang);
                    });
                });
            }

            function renderHeteronyms(lang) {
                heteronymsContainer.innerHTML = '';
                heteronyms.forEach(het => {
                    let imageHTML = `<div class="w-full h-64 bg-gray-200 flex items-center justify-center font-f3 text-lg text-center p-4 rounded-full shadow-md aspect-square mx-auto mb-4">${het.name.charAt(0)}</div>`;
                    if (het.image) {
                        imageHTML = `<img src="${het.image}" alt="${het.name}" class="w-full h-64 object-cover rounded-full shadow-md aspect-square mx-auto mb-4">`;
                    }

                    const bio = het.bio[lang] || het.bio.en;

                    const hetHTML = `
                        <div class="flex flex-col gap-4 text-center">
                            ${imageHTML}
                            <div>
                                <p class="font-f1 text-2xl">${het.name}</p>
                                <p class="font-f2 text-sm text-c2/80">${bio}</p>
                            </div>
                        </div>`;
                    heteronymsContainer.innerHTML += hetHTML;
                });
            }

            function renderFeaturedEssays(lang) {
                const container = document.getElementById('featured-essays');
                if (!container || !essays.length) return;

                // Get 3 most recent essays
                const featured = essays
                    .filter(e => e.status === 'published')
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 3);

                container.innerHTML = featured.map(essay => {
                    const slug = essay.slug[lang] || essay.slug.en;
                    const title = essay.title[lang] || essay.title.en;
                    const excerpt = essay.excerpt[lang] || essay.excerpt.en;

                    return `
                        <a href="/essays/${slug}.html" class="group bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-all border-b-2 border-transparent hover:border-c1">
                            <h3 class="font-f1 text-xl md:text-2xl mb-2 group-hover:text-c3 transition-colors">${title}</h3>
                            <p class="font-f2 text-sm text-c2/70 line-clamp-2">${excerpt}</p>
                            <span class="font-f3 text-xs text-c2/50 group-hover:text-c3 mt-3 inline-block transition-colors">Read ‚Üí</span>
                        </a>
                    `;
                }).join('');
            }

            function openBookModal(book, lang) {
                
                // Track book details view
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                    'event': 'view_book_details',
                    'book_title': book.title.en
                });

                const coverUrl = book.coverImage[lang] || book.coverImage.en;
                const bookTitle = book.title[lang] || book.title.en;
                const bookAuthors = (book.authors && book.authors.length > 0) ? `<p class="font-f2 text-lg mb-4 text-c2/80">${book.authors.join(' & ')}</p>` : '';
                const synopsisHTML = (book.synopsis[lang] || book.synopsis.en).split('\n').map(p => `<p class="mb-4">${p}</p>`).join('');

                // Special handling for fiction: Multiple stories support
                let readStoryHTML = '';
                if (book.stories && book.stories.length > 0) {
                    book.stories.forEach(storyId => {
                        const story = shortStories.find(s => s.id === storyId);
                        if (story) {
                            const btnLabel = story.title[lang] || story.title.en;
                            readStoryHTML += `<button class="font-f2 bg-c1 text-c2 font-bold py-2 px-4 rounded-md inline-block text-sm hover:opacity-90 transition-opacity mb-4 mr-2" onclick="openReader('${storyId}', '${lang}')">Read "${btnLabel}"</button>`;
                        }
                    });
                } else if (book.imprint === 'Fiction' || book.id === 'placeholder-book') {
                     // Fallback for placeholder
                     readStoryHTML = `<button class="font-f2 bg-c1 text-c2 font-bold py-2 px-4 rounded-md inline-block text-sm hover:opacity-90 transition-opacity mb-4 mr-2" onclick="openReader('placeholder-story', '${lang}')">Read a Short Story</button>`;
                }

                const bookStoresHTML = book.stores.filter(s => s.type === 'book').map(store => {
                    const eventData = {
                        'event': 'click_buy_now',
                        'book_title': book.title.en,
                        'store_name': store.name
                    };
                    return `<a href="${store.url}" onclick="dataLayer.push(${JSON.stringify(eventData)})" target="_blank" rel="noopener noreferrer" class="font-f2 bg-c3 text-c4 font-bold py-2 px-4 rounded-md inline-block text-sm hover:opacity-90 transition-opacity">${store.name}</a>`;
                }).join(' ');
                const audioStoresHTML = book.stores.filter(s => s.type === 'audiobook').map(store => {
                     const eventData = {
                        'event': 'click_buy_now',
                        'book_title': book.title.en,
                        'store_name': store.name
                    };
                    return `<a href="${store.url}" onclick="dataLayer.push(${JSON.stringify(eventData)})" target="_blank" rel="noopener noreferrer" class="font-f2 bg-c3 text-c4 font-bold py-2 px-4 rounded-md inline-block text-sm hover:opacity-90 transition-opacity">${store.name}</a>`;
                }).join(' ');
                const formatsHTML = book.formats.map(format => `<div class="font-f2 text-sm text-c2/80"><span class="font-bold">${content[lang][`format.${format.type}`]}:</span> ${format.isbn}</div>`).join('');
                
                const modalHTML = `
                    <div class="p-6 sm:p-8">
                        <div class="flex justify-between items-start mb-6">
                            <h3 class="font-f1 text-3xl md:text-4xl pr-4">${bookTitle}</h3>
                            <button id="close-modal" class="text-4xl text-c2/50 hover:text-c3 leading-none">√ó</button>
                        </div>
                        <div class="grid md:grid-cols-3 gap-8">
                            <div class="md:col-span-1">
                                <img src="${coverUrl}" alt="${book.title.en} cover" class="w-full object-contain rounded shadow-lg">
                            </div>
                            <div class="md:col-span-2">
                                ${bookAuthors}
                                <div class="font-f2 text-base text-c2/90 leading-relaxed">${synopsisHTML}</div>
                                <hr class="my-6">
                                
                                ${readStoryHTML}

                                <h4 class="font-f1 text-xl mb-3" data-key="modal.details">${content[lang]['modal.details']}</h4>
                                ${formatsHTML}
                                <hr class="my-6">
                                ${bookStoresHTML ? `<h4 class="font-f1 text-xl mb-3">${content[lang]['modal.stores_book']}</h4><div class="flex flex-wrap gap-3 mb-6">${bookStoresHTML}</div>` : ''}
                                ${audioStoresHTML ? `<h4 class="font-f1 text-xl mb-3">${content[lang]['modal.stores_audio']}</h4><div class="flex flex-wrap gap-3">${audioStoresHTML}</div>` : ''}
                                <hr class="my-6">
                                <button id="share-button" class="font-f2 text-sm text-c2/80 hover:text-c3" data-url="${window.location.origin}${window.location.pathname}#${book.id}">${content[lang]['modal.share']} üîó</button>
                            </div>
                        </div>
                    </div>`;

                bookModalContent.innerHTML = modalHTML;
                bookModal.classList.remove('hidden');
                setTimeout(() => {
                    bookModal.classList.remove('opacity-0');
                    bookModalContent.classList.remove('scale-95');
                }, 10);
                
                document.getElementById('close-modal').addEventListener('click', closeBookModal);
                document.getElementById('share-button').addEventListener('click', async e => {
                    const urlToCopy = e.target.dataset.url;
                    try {
                        await navigator.clipboard.writeText(urlToCopy);
                        e.target.textContent = 'Copied!';
                    } catch (err) {
                        // Fallback para navegadores antiguos
                        const textArea = document.createElement("textarea");
                        textArea.value = urlToCopy;
                        textArea.style.position = "fixed";
                        textArea.style.opacity = "0";
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand("copy");
                        document.body.removeChild(textArea);
                        e.target.textContent = 'Copied!';
                    }
                    setTimeout(() => { e.target.textContent = `${content[lang]['modal.share']} üîó` }, 2000);
                });
            }

            function closeBookModal() {
                bookModal.classList.add('opacity-0');
                bookModalContent.classList.add('scale-95');
                setTimeout(() => {
                    bookModal.classList.add('hidden');
                    try {
                        if (history.pushState) {
                            history.pushState("", document.title, window.location.pathname + window.location.search);
                        }
                    } catch (e) {
                        console.warn("Could not clear hash from URL:", e);
                    }
                }, 200);
            }
            
            bookModal.addEventListener('click', e => {
                if (e.target === bookModal) {
                    closeBookModal();
                }
            });

            // Reader Modal Logic
            window.openReader = function(storyId, lang) {
                const story = shortStories.find(s => s.id === storyId);
                if (!story) return;

                closeBookModal(); 

                const storyTitle = story.title[lang] || story.title.en;
                const storyUrl = story.src[lang] || story.src.en;
                
                // --- EXCERPT LOGIC ---
                const isExcerpt = story.isExcerpt || false;
                const buttonTextEn = isExcerpt ? "Continue reading on Amazon" : "Buy on Amazon";
                const buttonTextEs = isExcerpt ? "Sigue leyendo en Amazon" : "Comprar en Amazon";

                // --- BUTTON SETUP ---
                const buyBtn = document.getElementById('reader-buy-link');
                
                buyBtn.href = "https://www.amazon.co.uk/PAYLOAD-Short-Stories-Alden-Pierce-ebook/dp/B0G7KTMSTM";
                buyBtn.target = "_blank";
                buyBtn.rel = "noopener noreferrer";
                buyBtn.textContent = lang === 'es' ? buttonTextEs : buttonTextEn; // Use conditional text

                buyBtn.onclick = function() {
                    window.dataLayer = window.dataLayer || [];
                    window.dataLayer.push({
                        'event': 'click_buy_now',
                        'book_title': 'PAYLOAD (from Reader)',
                        'store_name': 'Amazon',
                        'story_read': storyTitle
                    });
                };

                // Show loading state
                readerContent.innerHTML = `
                    <h1 class="font-f1 text-4xl mb-4">${storyTitle}</h1>
                    <p class="font-f2 text-lg text-c2/60 mb-8">By ${story.author}</p>
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-4 py-1">
                            <div class="h-4 bg-slate-200 rounded w-3/4"></div>
                            <div class="h-4 bg-slate-200 rounded"></div>
                            <div class="h-4 bg-slate-200 rounded w-5/6"></div>
                        </div>
                    </div>
                    <p class="mt-4 text-sm text-gray-400">${content[lang]['reader.loading']}</p>
                `;

                readerModal.classList.remove('hidden');
                setTimeout(() => { readerModal.classList.remove('opacity-0'); }, 10);
                document.body.style.overflow = 'hidden';

                // Fetch the content file
                fetch(storyUrl)
                    .then(response => {
                        if (!response.ok) throw new Error('Network response was not ok');
                        return response.text();
                    })
                    .then(html => {
                        readerContent.innerHTML = `
                            <h1 class="font-f1 text-4xl mb-4">${storyTitle}</h1>
                            <p class="font-f2 text-lg text-c2/60 mb-8">By ${story.author}</p>
                            <div class="animate-in fade-in duration-500">
                                ${html}
                            </div>
                        `;
                    })
                    .catch(error => {
                        console.error('Error loading story:', error);
                        readerContent.innerHTML = `
                            <h1 class="font-f1 text-4xl mb-4">${storyTitle}</h1>
                            <div class="p-4 bg-red-50 text-red-600 rounded-md">
                                ${content[lang]['reader.error']}
                            </div>
                        `;
                    });
            };
            
            function closeReader() {
                readerModal.classList.add('opacity-0');
                setTimeout(() => {
                    readerModal.classList.add('hidden');
                    document.body.style.overflow = '';
                }, 200);
            }

            document.getElementById('close-reader').addEventListener('click', closeReader);


            let currentLang = 'en';
            function renderContent(lang) {
                currentLang = lang;
                localStorage.setItem('kwalia-lang', lang);
                document.querySelectorAll('[data-key]').forEach(el => { if (content[lang][el.getAttribute('data-key')]) { el.innerHTML = content[lang][el.getAttribute('data-key')]; } });
                document.querySelectorAll('[data-key-placeholder]').forEach(el => { if (content[lang][el.getAttribute('data-key-placeholder')]) { el.placeholder = content[lang][el.getAttribute('data-key-placeholder')]; } });
                
                // Press links logic (nota: no existe versi√≥n ES de AI Rights, usa EN como fallback)
                const udairPressLink = document.getElementById('udair-press-link');
                if (udairPressLink) {
                    udairPressLink.href = 'assets/kwalia-press-release-ai-rights-march2025.pdf';
                }

                const mindkindPressLink = document.getElementById('mindkind-press-link');
                if (mindkindPressLink) {
                    mindkindPressLink.href = lang === 'es'
                        ? 'assets/kwalia-nota-prensa-mindkind-julio-2025.pdf'
                        : 'assets/kwalia-press-release-mindkind-july2025.pdf';
                }

                // PAYLOAD press link (solo versi√≥n EN disponible)
                const payloadPressLink = document.getElementById('payload-press-link');
                if (payloadPressLink) {
                    payloadPressLink.href = 'assets/kwalia-press-release-payload-january2026.pdf';
                }

                renderCatalogue(lang);
                renderFiction(lang);
                renderHeteronyms(lang);
                renderFeaturedEssays(lang);

                const langEnDesktop = document.getElementById('lang-en-desktop');
                const langEsDesktop = document.getElementById('lang-es-desktop');
                const langEnMobile = document.getElementById('lang-en-mobile');
                const langEsMobile = document.getElementById('lang-es-mobile');

                langEnDesktop.classList.toggle('opacity-50', lang !== 'en');
                langEnDesktop.classList.toggle('font-bold', lang === 'en');
                langEsDesktop.classList.toggle('opacity-50', lang !== 'es');
                langEsDesktop.classList.toggle('font-bold', lang === 'es');
                
                if (langEnMobile) {
                    langEnMobile.classList.toggle('opacity-50', lang !== 'en');
                    langEnMobile.classList.toggle('font-bold', lang === 'en');
                }
                if (langEsMobile) {
                   langEsMobile.classList.toggle('opacity-50', lang !== 'es');
                   langEsMobile.classList.toggle('font-bold', lang === 'es');
                }
            }

            document.getElementById('lang-en-desktop').addEventListener('click', () => renderContent('en'));
            document.getElementById('lang-es-desktop').addEventListener('click', () => renderContent('es'));
            document.getElementById('lang-en-mobile').addEventListener('click', () => renderContent('en'));
            document.getElementById('lang-es-mobile').addEventListener('click', () => renderContent('es'));

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                        // Only prevent default if it actually starts with # AND isn't just a placeholder
                        if (href && href.startsWith('#') && href.length > 1) {
                        e.preventDefault();
                        const targetElement = document.querySelector(href);
                        if (targetElement) {
                            window.scrollTo({
                                 top: targetElement.offsetTop - document.getElementById('site-header').offsetHeight,
                                 behavior: "smooth"
                            });
                        }
                    }
                });
            });

            // Doodle Canvas Logic
            const doodleCanvas = document.getElementById('approach-doodle');
            const ctx = doodleCanvas.getContext('2d');
            let width, height;
            let bubbles = [];

            function initDoodle() {
                if (!doodleCanvas) return;
                width = doodleCanvas.offsetWidth;
                height = doodleCanvas.offsetHeight;
                doodleCanvas.width = width;
                doodleCanvas.height = height;

                bubbles = [];
                for (let i = 0; i < 15; i++) {
                    const radius = Math.random() * 50 + 10;
                    bubbles.push({
                        x: Math.random() * (width - radius * 2) + radius,
                        y: Math.random() * (height - radius * 2) + radius,
                        radius: radius,
                        color: i % 2 === 0 ? 'rgba(255, 255, 0, 0.5)' : 'rgba(255, 112, 166, 0.5)',
                        dx: (Math.random() - 0.5) * 0.2, // Very slow speed
                        dy: (Math.random() - 0.5) * 0.2  // Very slow speed
                    });
                }
            }

            let animationFrameId;
            function animateDoodle() {
                if (!doodleCanvas) return;
                ctx.clearRect(0, 0, width, height);

                bubbles.forEach(bubble => {
                    bubble.x += bubble.dx;
                    bubble.y += bubble.dy;
                    if (bubble.x + bubble.radius > width || bubble.x - bubble.radius < 0) { bubble.dx *= -1; }
                    if (bubble.y + bubble.radius > height || bubble.y - bubble.radius < 0) { bubble.dy *= -1; }
                    ctx.beginPath();
                    ctx.arc(bubble.x, bubble.y, bubble.radius, 0, Math.PI * 2);
                    ctx.fillStyle = bubble.color;
                    ctx.fill();
                });

                animationFrameId = requestAnimationFrame(animateDoodle);
            }

            // Mobile menu logic
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            mobileNavLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
            
            // Handle deep linking on page load
            function handleDeepLink() {
                const hash = window.location.hash.substring(1);
                if (!hash) return;

                const book = bookCatalogue.find(b => b.id === hash);
                if (book) {
                    openBookModal(book, currentLang);
                    return;
                }

                // Check fiction catalogue too
                const fictionBook = fictionCatalogue.find(b => b.id === hash);
                if (fictionBook) {
                    openBookModal(fictionBook, currentLang);
                }
            }

            // Initial render - restore saved language preference
            const savedLang = localStorage.getItem('kwalia-lang') || 'en';
            renderContent(savedLang);
            initDoodle();
            if(animationFrameId) cancelAnimationFrame(animationFrameId);
            animateDoodle();
            window.addEventListener('resize', initDoodle);
            handleDeepLink();

            // Re-scroll to hash after dynamic content loads (fixes navigation from other pages)
            if (window.location.hash && window.location.hash.length > 1) {
                const targetElement = document.querySelector(window.location.hash);
                if (targetElement) {
                    setTimeout(() => {
                        window.scrollTo({
                            top: targetElement.offsetTop - document.getElementById('site-header').offsetHeight,
                            behavior: 'smooth'
                        });
                    }, 100);
                }
            }
        });
    </script>
</body>
</html>




